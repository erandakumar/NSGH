<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Your Membership Card</title>
  <style>
    body {
      background: #000;
      color: #D4AF37;
      font-family: Arial;
      text-align: center;
      padding: 20px;
      margin: 0;
      display: flex;
      justify-content: center;
      align-items: center;
      min-height: 100vh;
    }
    .card {
      border: 3px solid #D4AF37;
      border-radius: 15px;
      max-width: 320px;
      padding: 20px;
    }
    #qr-code {
      margin: 20px auto;
      padding: 10px;
      background: white;
      border-radius: 5px;
      min-height: 150px;
      display: flex;
      flex-direction: column;
      justify-content: center;
    }
    .membership-id {
      font-size: 14px;
      word-break: break-all;
      margin-top: 10px;
    }
  </style>
</head>
<body>
  <div class="card">
    <h1>NEW SUN GOLD HOUSE</h1>
    <h2>Honor Member</h2>
    <div id="member-name">Member</div>
    <div id="member-since">Member Since: 5/8/2025</div>
    <div id="qr-code">
      <!-- QR code will appear here -->
    </div>
  </div>

  <script>
    document.addEventListener('DOMContentLoaded', function() {
      // Get URL parameters
      const params = new URLSearchParams(window.location.search);
      const name = params.get('name') || 'Member';
      const date = params.get('date') || new Date().toLocaleDateString();
      
      // Update member info
      document.getElementById('member-name').textContent = decodeURIComponent(name);
      document.getElementById('member-since').textContent = 'Member Since: ' + decodeURIComponent(date);
      
      // Self-contained QR code generator
      function generateQRCode(text, elementId) {
        const element = document.getElementById(elementId);
        const url = new URL(text);
        
        // Create a canvas element as fallback
        const canvas = document.createElement('canvas');
        canvas.width = 150;
        canvas.height = 150;
        const ctx = canvas.getContext('2d');
        
        // Simple QR-like pattern (basic implementation)
        ctx.fillStyle = '#ffffff';
        ctx.fillRect(0, 0, 150, 150);
        
        ctx.fillStyle = '#000000';
        // Draw simple squares pattern
        const positions = [
          [20,20,30,30], [60,20,30,30], [100,20,30,30],
          [20,60,30,30], [100,60,30,30],
          [20,100,30,30], [60,100,30,30], [100,100,30,30]
        ];
        
        positions.forEach(pos => {
          ctx.fillRect(pos[0], pos[1], pos[2], pos[3]);
        });
        
        // Add URL text below
        ctx.fillStyle = '#D4AF37';
        ctx.font = '10px Arial';
        ctx.fillText(url.hostname, 10, 140);
        
        // Add to DOM
        element.innerHTML = '';
        element.appendChild(canvas);
        
        // Add membership ID
        const idElement = document.createElement('div');
        idElement.className = 'membership-id';
        idElement.textContent = ID: ${name}-${date.replace(/\//g, '')};
        element.appendChild(idElement);
      }

      // Generate QR code using our fallback method
      generateQRCode(window.location.href, 'qr-code');
      
      // Try to load external QR library if needed
      if (typeof QRCode === 'undefined') {
        const script = document.createElement('script');
        script.src = 'https://cdn.jsdelivr.net/npm/qrcode@1.5.1/build/qrcode.min.js';
        script.onload = function() {
          try {
            const qrElement = document.getElementById("qr-code");
            qrElement.innerHTML = '';
            new QRCode(qrElement, {
              text: window.location.href,
              width: 150,
              height: 150,
              colorDark: "#D4AF37",
              colorLight: "#ffffff",
              correctLevel: QRCode.CorrectLevel.H
            });
          } catch (e) {
            console.log('Using fallback QR code');
          }
        };
        document.body.appendChild(script);
      }
    });
  </script>
</body>
</html>
